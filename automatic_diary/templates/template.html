<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <title>Automatic Diary Visualization</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <style>
         body {
             margin: 1em;
             font-family: B612;
             color: #444;
             position: relative;
         }
         h2 {
             text-align: right;
             font-weight: normal;
             font-size: 12pt;
             margin: 0;
         }
         .table {
             display: flex;
             flex-direction: column;
             width: 100%;
         }
         .tr {
             display: flex;
             flex-direction: row;
             position: relative;
         }
         .td,
         .th {
             width: 14.28%;
             padding: 0.25em;
             box-sizing: border-box;
         }
         .td {
             border: 1px solid #ddd;
             overflow: hidden;
             height: 100%;
         }
         .td:nth-child(5) {
             border-right-color: #444;
         }
         .td.even {
             background: #fcfcfc;
         }
         .th {
             text-align: center;
         }
         .cell {
             display: flex;
             flex-direction: column;
             height: 100%;
             min-height: 200px;
         }
         .content {
             flex-grow: 1;
         }
         .item {
             font-size: 10pt;
             margin: 0.25em 0;
         }
         .date {
             text-align: center;
             font-size: 10pt;
             color: #bbb;
         }
         .subprovider {
             display: none;
         }
         .line {
             stroke-width: 0.3;
             opacity: 0.2;
         }
         .csfd {
             color: #e6194b;
         }
         .line-csfd {
             stroke: #e6194b;
         }
         .caldav,
         .icalendar {
             background: #4363d8dd;
             color: #fff;
         }
         .todotxt {
             padding-bottom: 0.2em;
         }
         .todotxt .text {
             border-bottom: 0.2em solid #ffe119;
         }
         .line-todotxt {
             stroke: #ffe119;
         }
         .git {
             font-family: monospace;
             font-size: 9pt;
             display: flex;
         }
         .git .subprovider {
             display: block;
             white-space: nowrap;
             padding-right: 0.5em;
         }
         .git .text {
             display: block;
             color: #666;
         }
         .line-git {
             stroke: #666;
         }
         .facebook,
         .twitter {
             margin-top: 0.5em;
             margin-bottom: 0.5em;
             padding-left: 0.1em;
             padding-right: 0.1em;
             border-left: 0.5em solid #f032e633;
             border-right: 0.5em solid #f032e633;
             font-style: italic;
         }
         .maildir {
             padding-left: 1.5em;
         }
         .maildir::before {
             display: block;
             float: left;
             content: '\1F4E7';
             width: 1.5em;
             margin-left: -1.5em;
         }
         .csv {
             padding-left: 1.5em;
             color: #008080;
         }
         .csv::before {
             display: block;
             float: left;
             content: '\26BD';
             width: 1.5em;
             margin-left: -1.5em;
         }
         .line-csv {
             stroke: #008080;
         }
         .today {
             border: 1px dashed #000;
         }
         svg {
             position: absolute;
             left: 0;
             top: 0;
             width: 100%;
             height: 100%;
         }
        </style>
    </head>
    <body>
        <div class="table">
            <div class="tr">
                {% for weekday in ('mon', 'tue', 'wed', 'thu', 'fri', 'sat', 'sun') %}
                <div class="th">{{ weekday }}</div>
                {% endfor %}
            </div>
            {% for week in year %}
            <div class="tr">
                {% for day in week %}
                <div class="td{% if day.today %} today{% endif %}{% if day.even %} even{% endif %}">
                    <div class="cell">
                        <div class="content">
                            <h2 title="{{ day.date.isoformat() }}">{{ day.date.day }}</h2>
                            {% for item in day.items %}
                            <p class="item {{ item.provider }}">
                                <span class="subprovider">{{ item.subprovider }}</span>
                                <span class="text">{{ item.text }}</span>
                            </p>
                            {% endfor %}
                        </div>
                        <div class="date">{{ day.date.strftime('%b %Y') }}</div>
                    </div>
                </div>
                {% endfor %}
                <svg viewBox="-2 0 104 100" xmlns="http://www.w3.org/2000/svg"
                     preserveAspectRatio="none">
                    {% for provider, stat in week.stats.items() %}
                    <line x1="{{ stat.val }}"
                          y1="0"
                          x2="{{ stat.val }}"
                          y2="100"
                          class="line line-{{ provider }}" />
                    {% endfor %}
                </svg>
            </div>
            {% endfor %}
            <div class="tr">
                {% for weekday in ('mon', 'tue', 'wed', 'thu', 'fri', 'sat', 'sun') %}
                <div class="th">{{ weekday }}</div>
                {% endfor %}
            </div>
        </div>
    </body>
</html>
